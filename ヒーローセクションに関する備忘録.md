# ヒーローセクション本番移行マニュアル

このドキュメントは、Docker環境で開発した「アニメーション付きヒーローセクション」を本番環境のWordPressに移植する際の手順と注意点です。

## ⚠️ 特に重要な3つのポイント

移植時に失敗しやすいポイントです。必ずチェックしてください。

1. **画像のアップロード（最重要）**
   - コードだけをコピーしても画像は移動しません。
   - 本番サーバーの `wp-content/themes/cocoon-child-master` 内に、手動で `images` フォルダを作成し、`hero-bg.jpg` をアップロードしてください。
   - これを忘れると、背景が真っ暗になります。

2. **キャッシュの削除**
   - WP Super Cache や Autoptimize などのプラグインを使用している場合、移植直後は表示が崩れることがあります。
   - 作業完了後、必ずすべてのキャッシュをクリアしてください。

3. **反映の確認方法**
   - ブラウザにもキャッシュが残ります。確認時は `Ctrl + Shift + R` (Windows) または `Cmd + Shift + R` (Mac) でスーパーリロードしてください。

---

## 移植手順

### 1. ファイルの準備

以下のファイルを手元（または本番サーバー）に用意します。

- `functions.php` の追記コード（Docker環境の末尾にあるコード）
- `style.css` の追記コード（Docker環境の末尾にあるコード）
- `images/hero-bg.jpg`

### 2. ファイルのアップロード・編集

1. **画像の配置**
   FTPなどを使用して、本番サーバーの以下のパスに画像を配置します。
   `/wp-content/themes/cocoon-child-master/images/hero-bg.jpg`

2. **CSSの追記**
   本番サイトの「外観 > テーマファイルエディター」等から `style.css` を開き、開発環境で追加したCSSコードを末尾に貼り付けます。

3. **PHPの追記**
   同様に `functions.php` を開き、開発環境で追加したPHPコードを末尾に貼り付けます。
   ※ `<?php` タグの重複に注意してください。既存のファイルの末尾にそのまま追記します。

---

## 技術的な実装メモ（トラブルシューティング用）

もし表示トラブルが起きた際、開発者（または将来の自分）が見るためのメモです。

- **実装方式**: `wp_footer` フックで出力し、JavaScriptで移動させる方式。
  - 通常の `cocoon_after_header` フックが環境によって動作しなかったため、確実性の高いこの方式を採用しました。
- **動作ロジック**:
  1. ページ最下部（フッター）に HTML/JS を出力。
  2. `DOMContentLoaded` イベントで JS が発火。
  3. `#hero-section` を `#header` (または `.header-container`) の直下に `insertBefore` で移動。
- **表示されない場合**:
  - `functions.php` の JSコード内にある `var target = ...` の部分を確認。本番テーマのヘッダーIDが異なる場合、ここを修正する必要があります。
